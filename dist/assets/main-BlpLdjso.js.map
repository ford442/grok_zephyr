{"version":3,"file":"main-BlpLdjso.js","sources":["../../src/camera/CameraController.ts","../../src/ui/UIManager.ts","../../src/utils/PerformanceProfiler.ts","../../src/main.ts"],"sourcesContent":["/**\n * Grok Zephyr - Camera Controller\n * \n * Manages camera poses for different view modes:\n * - 720km Horizon View\n * - God View (orbiting free camera)\n * - Fleet POV (first-person satellite view)\n * - Surface View (ground perspective)\n */\n\nimport type { Vec3, ViewMode } from '@/types/index.js';\nimport { CONSTANTS, CAMERA, MATH, VIEW_MODES } from '@/types/constants.js';\nimport { v3, v3add, v3scale, v3norm, mat4lookAt, mat4persp } from '@/utils/math.js';\n\n/** Camera state for each view mode */\nexport interface CameraState {\n  position: Vec3;\n  target: Vec3;\n  up: Vec3;\n  fov: number;\n  near: number;\n  far: number;\n}\n\n/** God view orbit parameters */\nexport interface GodViewParams {\n  yaw: number;\n  pitch: number;\n  distance: number;\n}\n\n/** Mouse input state */\nexport interface MouseState {\n  down: boolean;\n  lastX: number;\n  lastY: number;\n}\n\n/**\n * Camera Controller\n * \n * Handles camera positioning for all view modes with smooth transitions\n * and mouse controls for God view.\n */\nexport class CameraController {\n  private currentMode: ViewMode = 'horizon-720';\n  private modeIndex = 0;\n  \n  // God view state\n  private godView: GodViewParams = {\n    yaw: 0,\n    pitch: 0.35,\n    distance: CAMERA.GOD_VIEW_DISTANCE,\n  };\n  \n  // Mouse state\n  private mouse: MouseState = {\n    down: false,\n    lastX: 0,\n    lastY: 0,\n  };\n  \n  // Callbacks\n  private modeChangeCallback: ((mode: ViewMode, name: string, altitude: string) => void) | null = null;\n\n  constructor() {\n    this.setupEventListeners();\n  }\n\n  /**\n   * Setup mouse and wheel event listeners\n   */\n  private setupEventListeners(): void {\n    // Will be attached to canvas in setViewTarget\n  }\n\n  /**\n   * Attach to canvas for mouse input\n   */\n  attachToCanvas(canvas: HTMLCanvasElement): void {\n    canvas.addEventListener('mousedown', (e) => {\n      this.mouse.down = true;\n      this.mouse.lastX = e.clientX;\n      this.mouse.lastY = e.clientY;\n    });\n\n    window.addEventListener('mouseup', () => {\n      this.mouse.down = false;\n    });\n\n    window.addEventListener('mousemove', (e) => {\n      if (!this.mouse.down || this.currentMode !== 'god') return;\n      \n      const dx = e.clientX - this.mouse.lastX;\n      const dy = e.clientY - this.mouse.lastY;\n      \n      this.godView.yaw += dx * 0.004;\n      this.godView.pitch = Math.max(\n        -1.4,\n        Math.min(1.4, this.godView.pitch - dy * 0.004)\n      );\n      \n      this.mouse.lastX = e.clientX;\n      this.mouse.lastY = e.clientY;\n    });\n\n    canvas.addEventListener('wheel', (e) => {\n      if (this.currentMode !== 'god') return;\n      \n      this.godView.distance = Math.max(\n        CAMERA.GOD_VIEW_MIN_DISTANCE,\n        Math.min(CAMERA.GOD_VIEW_MAX_DISTANCE, this.godView.distance + e.deltaY * 10)\n      );\n    });\n  }\n\n  /**\n   * Set view mode by index\n   */\n  setViewMode(index: number): void {\n    this.modeIndex = index;\n    \n    switch (index) {\n      case 0:\n        this.currentMode = 'horizon-720';\n        break;\n      case 1:\n        this.currentMode = 'god';\n        break;\n      case 2:\n        this.currentMode = 'sat-pov';\n        break;\n      case 3:\n        this.currentMode = 'ground';\n        break;\n      default:\n        this.currentMode = 'horizon-720';\n    }\n    \n    const config = VIEW_MODES[index] || VIEW_MODES[0];\n    \n    if (this.modeChangeCallback) {\n      this.modeChangeCallback(this.currentMode, config.name, config.altitude);\n    }\n  }\n\n  /**\n   * Get current view mode\n   */\n  getViewMode(): ViewMode {\n    return this.currentMode;\n  }\n\n  /**\n   * Get current view mode index\n   */\n  getViewModeIndex(): number {\n    return this.modeIndex;\n  }\n\n  /**\n   * Calculate camera state for current frame\n   */\n  calculateCamera(\n    satellitePosition: (index: number, time: number) => Vec3,\n    satelliteVelocity: (index: number, time: number) => Vec3,\n    time: number\n  ): CameraState {\n    switch (this.currentMode) {\n      case 'horizon-720':\n        return this.calculateHorizonView();\n      case 'god':\n        return this.calculateGodView();\n      case 'sat-pov':\n        return this.calculateFleetPOV(satellitePosition, satelliteVelocity, time);\n      case 'ground':\n        return this.calculateGroundView();\n      default:\n        return this.calculateHorizonView();\n    }\n  }\n\n  /**\n   * 720km Horizon View\n   * \n   * Camera at 720km altitude looking along the constellation\n   */\n  private calculateHorizonView(): CameraState {\n    return {\n      position: [CONSTANTS.CAMERA_RADIUS_KM, 0, 0],\n      target: [CONSTANTS.CAMERA_RADIUS_KM, 3000, 0],\n      up: [1, 0, 0],\n      fov: CAMERA.DEFAULT_FOV,\n      near: CAMERA.NEAR_PLANE,\n      far: CAMERA.FAR_PLANE,\n    };\n  }\n\n  /**\n   * God View\n   * \n   * Orbiting camera with mouse controls\n   */\n  private calculateGodView(): CameraState {\n    const { yaw, pitch, distance } = this.godView;\n    \n    const cosP = Math.cos(pitch);\n    const sinP = Math.sin(pitch);\n    const cosY = Math.cos(yaw);\n    const sinY = Math.sin(yaw);\n    \n    const position: Vec3 = [\n      cosP * cosY * distance,\n      cosP * sinY * distance,\n      sinP * distance,\n    ];\n    \n    // Avoid gimbal lock near poles\n    let up: Vec3 = [0, 0, 1];\n    if (Math.abs(pitch) > 1.35) {\n      up = [Math.cos(yaw), Math.sin(yaw), 0];\n    }\n    \n    return {\n      position,\n      target: [0, 0, 0],\n      up,\n      fov: CAMERA.DEFAULT_FOV,\n      near: CAMERA.NEAR_PLANE,\n      far: CAMERA.FAR_PLANE,\n    };\n  }\n\n  /**\n   * Fleet POV\n   * \n   * Follow satellite #0 in first-person\n   */\n  private calculateFleetPOV(\n    getPosition: (index: number, time: number) => Vec3,\n    getVelocity: (index: number, time: number) => Vec3,\n    time: number\n  ): CameraState {\n    const satPos = getPosition(0, time);\n    const satVel = getVelocity(0, time);\n    \n    // Camera slightly above satellite\n    const radial = v3norm(satPos);\n    const position = v3add(satPos, v3scale(radial, 15));\n    const target = v3add(position, satVel);\n    \n    return {\n      position,\n      target,\n      up: radial,\n      fov: CAMERA.DEFAULT_FOV,\n      near: 1.0,\n      far: CAMERA.FAR_PLANE,\n    };\n  }\n\n  /**\n   * Ground View\n   *\n   * Camera on Earth's surface looking upward at the night sky.\n   * Position: surface of Earth on +X axis (altitude 0 km).\n   * Target: orbit altitude along +X (pointing radially outward toward zenith).\n   * Up: +Z so the horizon aligns naturally.\n   */\n  private calculateGroundView(): CameraState {\n    return {\n      position: [CONSTANTS.EARTH_RADIUS_KM, 0, 0],\n      target: [CONSTANTS.ORBIT_RADIUS_KM, 0, 0],\n      up: [0, 0, 1],\n      fov: CAMERA.DEFAULT_FOV,\n      near: 1.0,\n      far: CAMERA.FAR_PLANE,\n    };\n  }\n\n  /**\n   * Build view-projection matrix from camera state\n   */\n  buildViewProjection(camera: CameraState, aspect: number): {\n    view: Float32Array;\n    projection: Float32Array;\n    viewProjection: Float32Array;\n  } {\n    const view = mat4lookAt(\n      camera.position,\n      camera.target,\n      camera.up\n    );\n    \n    const projection = mat4persp(\n      camera.fov,\n      aspect,\n      camera.near,\n      camera.far\n    );\n    \n    const viewProjection = new Float32Array(16);\n    // Manual matrix multiply\n    for (let c = 0; c < 4; c++) {\n      for (let r = 0; r < 4; r++) {\n        let sum = 0;\n        for (let k = 0; k < 4; k++) {\n          sum += projection[r + k * 4] * view[k + c * 4];\n        }\n        viewProjection[r + c * 4] = sum;\n      }\n    }\n    \n    return { view, projection, viewProjection };\n  }\n\n  /**\n   * Get camera right and up vectors from view matrix\n   */\n  getCameraAxes(viewMatrix: Float32Array): {\n    right: Vec3;\n    up: Vec3;\n  } {\n    return {\n      right: [viewMatrix[0], viewMatrix[4], viewMatrix[8]],\n      up: [viewMatrix[1], viewMatrix[5], viewMatrix[9]],\n    };\n  }\n\n  /**\n   * Register mode change callback\n   */\n  onModeChange(callback: (mode: ViewMode, name: string, altitude: string) => void): void {\n    this.modeChangeCallback = callback;\n  }\n\n  /**\n   * Reset God view to default\n   */\n  resetGodView(): void {\n    this.godView = {\n      yaw: 0,\n      pitch: 0.35,\n      distance: CAMERA.GOD_VIEW_DISTANCE,\n    };\n  }\n\n  /**\n   * Get all available view modes\n   */\n  getViewModes(): typeof VIEW_MODES {\n    return VIEW_MODES;\n  }\n}\n\nexport default CameraController;\n","/**\n * Grok Zephyr - UI Manager\n * \n * Handles HUD updates, stats display, and control buttons.\n */\n\nimport type { PerformanceStats } from '@/types/index.js';\nimport { VIEW_MODES } from '@/types/constants.js';\n\n/** UI element references */\nexport interface UIElements {\n  altitude: HTMLElement;\n  fleet: HTMLElement;\n  fps: HTMLElement;\n  viewMode: HTMLElement;\n  visible: HTMLElement;\n  error: HTMLElement;\n  controls: HTMLElement;\n  buttons: HTMLButtonElement[];\n  horizonIndicator: HTMLElement;\n}\n\n/**\n * UI Manager\n * \n * Manages all UI updates and interactions.\n */\nexport class UIManager {\n  private elements: UIElements;\n  private onViewChange: ((index: number) => void) | null = null;\n\n  constructor() {\n    this.elements = this.getElements();\n    this.setupEventListeners();\n  }\n\n  /**\n   * Get references to UI elements\n   */\n  private getElements(): UIElements {\n    const getEl = (id: string) => document.getElementById(id)!;\n    \n    return {\n      altitude: getEl('s-alt'),\n      fleet: getEl('s-fleet'),\n      fps: getEl('s-fps'),\n      viewMode: getEl('s-view'),\n      visible: getEl('s-visible'),\n      error: getEl('error'),\n      controls: getEl('controls'),\n      buttons: [\n        document.getElementById('btn0') as HTMLButtonElement,\n        document.getElementById('btn1') as HTMLButtonElement,\n        document.getElementById('btn2') as HTMLButtonElement,\n        document.getElementById('btn3') as HTMLButtonElement,\n      ],\n      horizonIndicator: getEl('horizon-indicator'),\n    };\n  }\n\n  /**\n   * Setup event listeners for controls\n   */\n  private setupEventListeners(): void {\n    this.elements.buttons.forEach((btn, index) => {\n      btn.addEventListener('click', () => {\n        this.setActiveButton(index);\n        if (this.onViewChange) {\n          this.onViewChange(index);\n        }\n      });\n    });\n  }\n\n  /**\n   * Set the active view mode button\n   */\n  setActiveButton(index: number): void {\n    this.elements.buttons.forEach((btn, i) => {\n      btn.classList.toggle('active', i === index);\n    });\n  }\n\n  /**\n   * Update view mode display\n   */\n  setViewMode(modeName: string, altitude: string): void {\n    this.elements.viewMode.textContent = `View     : ${modeName}`;\n    this.elements.altitude.textContent = `Altitude : ${altitude} km`;\n    \n    // Show/hide horizon indicator\n    if (modeName === '720km Horizon') {\n      this.elements.horizonIndicator.style.display = 'block';\n    } else {\n      this.elements.horizonIndicator.style.display = 'none';\n    }\n  }\n\n  /**\n   * Update FPS display\n   */\n  setFPS(fps: number): void {\n    this.elements.fps.textContent = `FPS      : ${fps}`;\n  }\n\n  /**\n   * Update fleet count\n   */\n  setFleetCount(count: number): void {\n    this.elements.fleet.textContent = `Fleet    : ${count.toLocaleString()}`;\n  }\n\n  /**\n   * Update visible satellite count\n   */\n  setVisibleCount(count: number): void {\n    this.elements.visible.textContent = `Visible  : ${count.toLocaleString()}`;\n  }\n\n  /**\n   * Update all stats from performance data\n   */\n  updateStats(stats: PerformanceStats): void {\n    this.setFPS(stats.fps);\n    this.setVisibleCount(stats.visibleSatellites);\n  }\n\n  /**\n   * Show error message\n   */\n  showError(message: string): void {\n    this.elements.error.style.display = 'block';\n    this.elements.error.innerHTML = `<b>WebGPU Error</b><br>${message}`;\n  }\n\n  /**\n   * Hide error message\n   */\n  hideError(): void {\n    this.elements.error.style.display = 'none';\n  }\n\n  /**\n   * Register view change callback\n   */\n  onViewModeChange(callback: (index: number) => void): void {\n    this.onViewChange = callback;\n  }\n\n  /**\n   * Get button elements for external control\n   */\n  getButtons(): HTMLButtonElement[] {\n    return this.elements.buttons;\n  }\n\n  /**\n   * Create UI HTML structure\n   * Call this if the HTML doesn't have the required elements\n   */\n  static createUI(): string {\n    return `\n      <div id=\"ui\">\n        <div class=\"title\">â—ˆ GROK ZEPHYR</div>\n        <div class=\"stat\" id=\"s-alt\">Altitude : 720 km</div>\n        <div class=\"stat\" id=\"s-fleet\">Fleet    : 1,048,576</div>\n        <div class=\"stat\" id=\"s-fps\">FPS      : --</div>\n        <div class=\"stat\" id=\"s-view\">View     : 720km Horizon</div>\n        <div class=\"stat\" id=\"s-visible\">Visible  : --</div>\n      </div>\n      <div id=\"controls\">\n        <button class=\"vbtn active\" id=\"btn0\">720km HORIZON</button>\n        <button class=\"vbtn\" id=\"btn1\">GOD VIEW</button>\n        <button class=\"vbtn\" id=\"btn2\">FLEET POV</button>\n        <button class=\"vbtn\" id=\"btn3\">GROUND VIEW</button>\n      </div>\n      <div id=\"horizon-indicator\">\n        <div>Earth Radius: 6,371 km</div>\n        <div>Orbit Altitude: 550 km</div>\n        <div>Camera Altitude: 720 km</div>\n        <div>Horizon Distance: ~2,970 km</div>\n      </div>\n      <div id=\"error\"></div>\n    `;\n  }\n}\n\nexport default UIManager;\n","/**\n * Grok Zephyr - Performance Profiler\n * \n * Tracks GPU and CPU performance metrics including:\n * - FPS with moving average\n * - Frame time\n * - GPU memory usage\n * - Compute and render pass timing\n */\n\nimport type { PerformanceStats } from '@/types/index.js';\nimport { UI } from '@/types/constants.js';\n\n/** Performance metric history entry */\ninterface MetricHistory {\n  values: number[];\n  maxSize: number;\n  sum: number;\n}\n\n/** GPU timing query pair */\ninterface GPUTimingQuery {\n  querySet: GPUQuerySet;\n  resolveBuffer: GPUBuffer;\n  resultBuffer: GPUBuffer | null;\n  startIndex: number;\n  endIndex: number;\n}\n\n/** Performance profiler options */\nexport interface PerformanceProfilerOptions {\n  /** Enable GPU timestamp queries */\n  enableGPUTiming: boolean;\n  /** History size for moving averages */\n  historySize: number;\n  /** FPS update interval in seconds */\n  fpsUpdateInterval: number;\n}\n\n/**\n * Performance Profiler\n * \n * Monitors simulation performance with:\n * - CPU-side FPS calculation\n * - GPU timestamp queries (if supported)\n * - Memory usage tracking\n * - Moving average smoothing\n */\nexport class PerformanceProfiler {\n  private options: PerformanceProfilerOptions;\n  \n  // FPS tracking\n  private frameCount = 0;\n  private lastFpsTime = 0;\n  private currentFps = 0;\n  \n  // Frame timing\n  private lastFrameTime = 0;\n  private frameTimeHistory: MetricHistory;\n  \n  // GPU timing\n  private device: GPUDevice | null = null;\n  private supportsGPUTiming = false;\n  private timingQuery: GPUTimingQuery | null = null;\n  private pendingQueries = 0;\n  \n  // Pass timing\n  private computeTimeHistory: MetricHistory;\n  private renderTimeHistory: MetricHistory;\n  \n  // Stats\n  private visibleSatellites = 0;\n  private gpuMemoryMB = 0;\n  \n  // Callbacks\n  private statsCallback: ((stats: PerformanceStats) => void) | null = null;\n\n  constructor(options: Partial<PerformanceProfilerOptions> = {}) {\n    this.options = {\n      enableGPUTiming: true,\n      historySize: 60,\n      fpsUpdateInterval: UI.FPS_UPDATE_INTERVAL,\n      ...options,\n    };\n    \n    this.frameTimeHistory = this.createHistory(this.options.historySize);\n    this.computeTimeHistory = this.createHistory(this.options.historySize);\n    this.renderTimeHistory = this.createHistory(this.options.historySize);\n  }\n\n  /**\n   * Initialize GPU timing support\n   */\n  async initialize(device: GPUDevice): Promise<void> {\n    this.device = device;\n    \n    // Check for timestamp query support on the device (not just adapter)\n    // The feature must be enabled when creating the device\n    this.supportsGPUTiming = device.features.has('timestamp-query');\n    \n    if (this.supportsGPUTiming && this.options.enableGPUTiming) {\n      try {\n        this.initializeGPUTiming();\n      } catch (error) {\n        console.warn('[PerformanceProfiler] Failed to initialize GPU timing:', error);\n        this.supportsGPUTiming = false;\n      }\n    }\n    \n    console.log(`[PerformanceProfiler] GPU timing: ${this.supportsGPUTiming ? 'enabled' : 'disabled'}`);\n  }\n\n  /**\n   * Initialize GPU timestamp queries\n   */\n  private initializeGPUTiming(): void {\n    if (!this.device) return;\n    \n    // Create query set for 2 timestamps per frame (start/end)\n    const querySet = this.device.createQuerySet({\n      type: 'timestamp',\n      count: 4, // 2 for compute, 2 for render\n    });\n    \n    // Create resolve buffer\n    const resolveBuffer = this.device.createBuffer({\n      size: 4 * 8, // 4 timestamps * 8 bytes each\n      usage: GPUBufferUsage.QUERY_RESOLVE | GPUBufferUsage.COPY_SRC,\n    });\n    \n    this.timingQuery = {\n      querySet,\n      resolveBuffer,\n      resultBuffer: null,\n      startIndex: 0,\n      endIndex: 1,\n    };\n  }\n\n  /**\n   * Begin frame timing\n   */\n  beginFrame(timestamp: number): void {\n    this.lastFrameTime = timestamp;\n  }\n\n  /**\n   * End frame timing and calculate FPS\n   */\n  endFrame(timestamp: number): PerformanceStats | null {\n    const now = timestamp * 0.001; // Convert to seconds\n    const frameTimeMs = (timestamp - this.lastFrameTime);\n    \n    // Update frame time history\n    this.addToHistory(this.frameTimeHistory, frameTimeMs);\n    \n    // Update FPS\n    this.frameCount++;\n    const elapsed = now - this.lastFpsTime;\n    \n    if (elapsed >= this.options.fpsUpdateInterval) {\n      this.currentFps = Math.round(this.frameCount / elapsed);\n      this.frameCount = 0;\n      this.lastFpsTime = now;\n      \n      // Update GPU memory if available\n      this.updateGPUMemory();\n      \n      // Create stats object\n      const stats: PerformanceStats = {\n        fps: this.currentFps,\n        frameTime: this.getAverage(this.frameTimeHistory),\n        gpuMemoryMB: this.gpuMemoryMB,\n        visibleSatellites: this.visibleSatellites,\n        computeTime: this.getAverage(this.computeTimeHistory),\n        renderTime: this.getAverage(this.renderTimeHistory),\n      };\n      \n      // Notify callback\n      if (this.statsCallback) {\n        this.statsCallback(stats);\n      }\n      \n      return stats;\n    }\n    \n    return null;\n  }\n\n  /**\n   * Record compute pass timing\n   */\n  recordComputeTime(timeMs: number): void {\n    this.addToHistory(this.computeTimeHistory, timeMs);\n  }\n\n  /**\n   * Record render pass timing\n   */\n  recordRenderTime(timeMs: number): void {\n    this.addToHistory(this.renderTimeHistory, timeMs);\n  }\n\n  /**\n   * Update visible satellite count\n   */\n  setVisibleSatellites(count: number): void {\n    this.visibleSatellites = count;\n  }\n\n  /**\n   * Set GPU memory usage\n   */\n  setGPUMemoryMB(mb: number): void {\n    this.gpuMemoryMB = mb;\n  }\n\n  /**\n   * Register stats update callback\n   */\n  onStatsUpdate(callback: (stats: PerformanceStats) => void): void {\n    this.statsCallback = callback;\n  }\n\n  /**\n   * Get current stats snapshot\n   */\n  getStats(): PerformanceStats {\n    return {\n      fps: this.currentFps,\n      frameTime: this.getAverage(this.frameTimeHistory),\n      gpuMemoryMB: this.gpuMemoryMB,\n      visibleSatellites: this.visibleSatellites,\n      computeTime: this.getAverage(this.computeTimeHistory),\n      renderTime: this.getAverage(this.renderTimeHistory),\n    };\n  }\n\n  /**\n   * Begin GPU timing for a pass\n   */\n  beginGPUPass(encoder: GPUCommandEncoder, passType: 'compute' | 'render'): void {\n    if (!this.timingQuery || !this.supportsGPUTiming) return;\n    \n    const index = passType === 'compute' ? 0 : 2;\n    encoder.writeTimestamp(this.timingQuery.querySet, index);\n  }\n\n  /**\n   * End GPU timing for a pass\n   */\n  endGPUPass(encoder: GPUCommandEncoder, passType: 'compute' | 'render'): void {\n    if (!this.timingQuery || !this.supportsGPUTiming) return;\n    \n    const index = passType === 'compute' ? 1 : 3;\n    encoder.writeTimestamp(this.timingQuery.querySet, index);\n  }\n\n  /**\n   * Resolve GPU timestamps\n   */\n  resolveTimestamps(encoder: GPUCommandEncoder): void {\n    if (!this.timingQuery || !this.supportsGPUTiming) return;\n    \n    encoder.resolveQuerySet(\n      this.timingQuery.querySet,\n      0,\n      4,\n      this.timingQuery.resolveBuffer,\n      0\n    );\n    \n    // Create result buffer if needed\n    if (!this.timingQuery.resultBuffer) {\n      this.timingQuery.resultBuffer = this.device!.createBuffer({\n        size: 4 * 8,\n        usage: GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ,\n      });\n    }\n    \n    encoder.copyBufferToBuffer(\n      this.timingQuery.resolveBuffer,\n      0,\n      this.timingQuery.resultBuffer,\n      0,\n      4 * 8\n    );\n    \n    this.pendingQueries++;\n  }\n\n  /**\n   * Read back GPU timing results\n   */\n  async readbackTimestamps(): Promise<void> {\n    if (!this.timingQuery?.resultBuffer || this.pendingQueries === 0) return;\n    \n    const buffer = this.timingQuery.resultBuffer;\n    \n    await buffer.mapAsync(GPUMapMode.READ);\n    const data = new BigInt64Array(buffer.getMappedRange());\n    \n    // Convert nanoseconds to milliseconds\n    const computeTime = Number(data[1] - data[0]) / 1_000_000;\n    const renderTime = Number(data[3] - data[2]) / 1_000_000;\n    \n    buffer.unmap();\n    \n    if (computeTime > 0 && computeTime < 1000) {\n      this.addToHistory(this.computeTimeHistory, computeTime);\n    }\n    if (renderTime > 0 && renderTime < 1000) {\n      this.addToHistory(this.renderTimeHistory, renderTime);\n    }\n    \n    this.pendingQueries--;\n  }\n\n  /**\n   * Update GPU memory from performance API (if available)\n   */\n  private updateGPUMemory(): void {\n    // Check for WebGPU memory info extension\n    const perf = performance as Performance & {\n      memory?: { usedJSHeapSize: number; totalJSHeapSize: number };\n    };\n    \n    if (perf.memory) {\n      // This is JavaScript heap, not GPU memory, but useful as reference\n      const jsHeapMB = perf.memory.usedJSHeapSize / 1024 / 1024;\n      this.gpuMemoryMB = Math.max(this.gpuMemoryMB, jsHeapMB);\n    }\n  }\n\n  /**\n   * Create a metric history buffer\n   */\n  private createHistory(maxSize: number): MetricHistory {\n    return {\n      values: [],\n      maxSize,\n      sum: 0,\n    };\n  }\n\n  /**\n   * Add value to history with moving average\n   */\n  private addToHistory(history: MetricHistory, value: number): void {\n    // Remove oldest if at capacity\n    if (history.values.length >= history.maxSize) {\n      history.sum -= history.values.shift()!;\n    }\n    \n    history.values.push(value);\n    history.sum += value;\n  }\n\n  /**\n   * Get average from history\n   */\n  private getAverage(history: MetricHistory): number {\n    if (history.values.length === 0) return 0;\n    return history.sum / history.values.length;\n  }\n\n  /**\n   * Reset all metrics\n   */\n  reset(): void {\n    this.frameCount = 0;\n    this.lastFpsTime = 0;\n    this.currentFps = 0;\n    this.frameTimeHistory = this.createHistory(this.options.historySize);\n    this.computeTimeHistory = this.createHistory(this.options.historySize);\n    this.renderTimeHistory = this.createHistory(this.options.historySize);\n    this.visibleSatellites = 0;\n  }\n\n  /**\n   * Destroy and cleanup\n   */\n  destroy(): void {\n    if (this.timingQuery) {\n      this.timingQuery.querySet.destroy();\n      this.timingQuery.resolveBuffer.destroy();\n      this.timingQuery.resultBuffer?.destroy();\n      this.timingQuery = null;\n    }\n    this.device = null;\n  }\n}\n\n/**\n * Simple FPS counter for basic usage\n */\nexport class FPSCounter {\n  private frameCount = 0;\n  private lastTime = 0;\n  private currentFps = 0;\n  private callback: ((fps: number) => void) | null = null;\n  private interval: number;\n\n  constructor(interval = 0.5) {\n    this.interval = interval;\n  }\n\n  onUpdate(callback: (fps: number) => void): void {\n    this.callback = callback;\n  }\n\n  tick(timestamp: number): number {\n    const now = timestamp * 0.001;\n    this.frameCount++;\n    \n    const elapsed = now - this.lastTime;\n    if (elapsed >= this.interval) {\n      this.currentFps = Math.round(this.frameCount / elapsed);\n      this.frameCount = 0;\n      this.lastTime = now;\n      \n      if (this.callback) {\n        this.callback(this.currentFps);\n      }\n    }\n    \n    return this.currentFps;\n  }\n\n  getFPS(): number {\n    return this.currentFps;\n  }\n\n  reset(): void {\n    this.frameCount = 0;\n    this.lastTime = 0;\n    this.currentFps = 0;\n  }\n}\n\nexport default PerformanceProfiler;\n","/**\n * Grok Zephyr - Main Entry Point\n * \n * WebGPU-powered orbital simulation with 1M+ satellites.\n */\n\nimport { WebGPUContext, WebGPUError } from '@/core/WebGPUContext.js';\nimport { SatelliteGPUBuffer } from '@/core/SatelliteGPUBuffer.js';\nimport { RenderPipeline } from '@/render/RenderPipeline.js';\nimport { CameraController } from '@/camera/CameraController.js';\nimport { UIManager } from '@/ui/UIManager.js';\nimport { PerformanceProfiler } from '@/utils/PerformanceProfiler.js';\nimport { genSphere, extractFrustum } from '@/utils/math.js';\nimport { CONSTANTS, RENDER, CAMERA, BUFFER_SIZES } from '@/types/constants.js';\n\nimport './styles.css';\n\n/**\n * Main Application Class\n */\nclass GrokZephyrApp {\n  private canvas: HTMLCanvasElement;\n  private context: WebGPUContext | null = null;\n  private buffers: SatelliteGPUBuffer | null = null;\n  private pipeline: RenderPipeline | null = null;\n  private camera: CameraController;\n  private ui: UIManager;\n  private profiler: PerformanceProfiler;\n  \n  // Earth geometry\n  private earthVertexBuffer: GPUBuffer | null = null;\n  private earthIndexBuffer: GPUBuffer | null = null;\n  private earthIndexCount = 0;\n  \n  // Animation state\n  private animationId = 0;\n  private isRunning = false;\n  private lastTime = 0;\n\n  constructor() {\n    const canvas = document.getElementById('gpu-canvas') as HTMLCanvasElement;\n    if (!canvas) {\n      throw new Error('Canvas element #gpu-canvas not found');\n    }\n    this.canvas = canvas;\n    \n    this.camera = new CameraController();\n    this.ui = new UIManager();\n    this.profiler = new PerformanceProfiler();\n    \n    // Setup callbacks\n    this.setupCallbacks();\n  }\n\n  /**\n   * Setup UI and camera callbacks\n   */\n  private setupCallbacks(): void {\n    // Camera mode change updates UI\n    this.camera.onModeChange((mode, name, altitude) => {\n      this.ui.setViewMode(name, altitude);\n      this.ui.setActiveButton(this.camera.getViewModeIndex());\n    });\n\n    // UI view change updates camera\n    this.ui.onViewModeChange((index) => {\n      this.camera.setViewMode(index);\n    });\n\n    // Stats update\n    this.profiler.onStatsUpdate((stats) => {\n      this.ui.updateStats(stats);\n    });\n  }\n\n  /**\n   * Initialize the application\n   */\n  async initialize(): Promise<void> {\n    try {\n      console.log('[GrokZephyr] Initializing...');\n      \n      // Initialize WebGPU\n      this.context = new WebGPUContext(this.canvas);\n      const { device } = await this.context.initialize();\n      \n      // Initialize performance profiler\n      await this.profiler.initialize(device);\n      \n      // Attach camera to canvas\n      this.camera.attachToCanvas(this.canvas);\n      \n      // Initialize buffers\n      this.buffers = new SatelliteGPUBuffer(this.context);\n      const bufferSet = this.buffers.initialize();\n      \n      // Generate and upload orbital elements\n      this.buffers.generateOrbitalElements();\n      this.buffers.uploadOrbitalElements();\n      \n      // Create Earth geometry\n      this.createEarthGeometry();\n      \n      // Initialize render pipeline\n      this.pipeline = new RenderPipeline(this.context, bufferSet);\n      \n      // Set initial canvas size and initialize pipeline\n      const dpr = window.devicePixelRatio || 1;\n      const width = Math.floor(this.canvas.clientWidth * dpr);\n      const height = Math.floor(this.canvas.clientHeight * dpr);\n      this.pipeline.initialize(width, height);\n      this.buffers.updateBloomUniforms(width, height);\n      \n      // Update UI\n      this.ui.setFleetCount(CONSTANTS.NUM_SATELLITES);\n      this.ui.hideError();\n      \n      // Set initial view mode\n      this.camera.setViewMode(0);\n      \n      // Start render loop\n      this.start();\n      \n      console.log('[GrokZephyr] Initialization complete');\n      \n    } catch (error) {\n      this.handleError(error);\n    }\n  }\n\n  /**\n   * Create Earth sphere geometry\n   */\n  private createEarthGeometry(): void {\n    if (!this.context) return;\n    \n    const sphere = genSphere(\n      CONSTANTS.EARTH_RADIUS_KM,\n      64, // rings\n      64  // segments\n    );\n    \n    this.earthIndexCount = sphere.indices.length;\n    \n    // Interleave position and normal data\n    const vertexCount = sphere.vertices.length / 3;\n    const interleaved = new Float32Array(vertexCount * 6);\n    \n    for (let i = 0; i < vertexCount; i++) {\n      interleaved[i * 6 + 0] = sphere.vertices[i * 3 + 0];\n      interleaved[i * 6 + 1] = sphere.vertices[i * 3 + 1];\n      interleaved[i * 6 + 2] = sphere.vertices[i * 3 + 2];\n      interleaved[i * 6 + 3] = sphere.normals[i * 3 + 0];\n      interleaved[i * 6 + 4] = sphere.normals[i * 3 + 1];\n      interleaved[i * 6 + 5] = sphere.normals[i * 3 + 2];\n    }\n    \n    this.earthVertexBuffer = this.context.createVertexBuffer(interleaved.byteLength);\n    this.context.writeBuffer(this.earthVertexBuffer, interleaved);\n    \n    this.earthIndexBuffer = this.context.createIndexBuffer(sphere.indices.byteLength);\n    this.context.writeBuffer(this.earthIndexBuffer, sphere.indices);\n  }\n\n  /**\n   * Handle window resize\n   */\n  private handleResize(): void {\n    if (!this.context || !this.buffers || !this.pipeline) return;\n    \n    const dpr = window.devicePixelRatio || 1;\n    const width = Math.floor(this.canvas.clientWidth * dpr);\n    const height = Math.floor(this.canvas.clientHeight * dpr);\n    \n    this.context.resize(width, height);\n    this.pipeline.resize(width, height);\n    this.buffers.updateBloomUniforms(width, height);\n  }\n\n  /**\n   * Write uniform buffer data\n   */\n  private writeUniforms(time: number, deltaTime: number): void {\n    if (!this.context || !this.buffers) return;\n    \n    const { width, height } = this.context.getCanvasSize();\n    const aspect = width / height;\n    \n    // Calculate camera\n    const camera = this.camera.calculateCamera(\n      (idx, t) => this.buffers!.calculateSatellitePosition(idx, t),\n      (idx, t) => this.buffers!.calculateSatelliteVelocity(idx, t),\n      time\n    );\n    \n    const { viewProjection, view } = this.camera.buildViewProjection(camera, aspect);\n    const { right, up } = this.camera.getCameraAxes(view);\n    \n    // Extract frustum planes\n    const frustum = extractFrustum(viewProjection);\n    \n    // Build uniform buffer (256 bytes)\n    const uniformData = new ArrayBuffer(BUFFER_SIZES.UNIFORM);\n    const f32 = new Float32Array(uniformData);\n    const u32 = new Uint32Array(uniformData);\n    \n    // View-projection matrix (0-63)\n    f32.set(viewProjection, 0);\n    \n    // Camera position (64-79)\n    f32[16] = camera.position[0];\n    f32[17] = camera.position[1];\n    f32[18] = camera.position[2];\n    f32[19] = 1.0;\n    \n    // Camera right (80-95)\n    f32[20] = right[0];\n    f32[21] = right[1];\n    f32[22] = right[2];\n    f32[23] = 0.0;\n    \n    // Camera up (96-111)\n    f32[24] = up[0];\n    f32[25] = up[1];\n    f32[26] = up[2];\n    f32[27] = 0.0;\n    \n    // Time, delta time, view mode (112-123)\n    f32[28] = time;\n    f32[29] = deltaTime;\n    u32[30] = this.camera.getViewModeIndex();\n    u32[31] = 0;\n    \n    // Frustum planes (128-223) - 6 planes * 4 floats each\n    for (let p = 0; p < 6; p++) {\n      f32[32 + p * 4 + 0] = frustum[p][0];\n      f32[32 + p * 4 + 1] = frustum[p][1];\n      f32[32 + p * 4 + 2] = frustum[p][2];\n      f32[32 + p * 4 + 3] = frustum[p][3];\n    }\n    \n    // Screen size (224-231)\n    f32[56] = width;\n    f32[57] = height;\n    f32[58] = 0.0;\n    f32[59] = 0.0;\n    \n    // Write to GPU\n    this.context.writeBuffer(this.buffers.getBuffers().uniforms, uniformData);\n  }\n\n  /**\n   * Main render loop\n   */\n  private render = (timestamp: number): void => {\n    if (!this.isRunning || !this.context || !this.pipeline || !this.earthVertexBuffer || !this.earthIndexBuffer) {\n      return;\n    }\n    \n    // Handle resize\n    const dpr = window.devicePixelRatio || 1;\n    const width = Math.floor(this.canvas.clientWidth * dpr);\n    const height = Math.floor(this.canvas.clientHeight * dpr);\n    if (width !== this.canvas.width || height !== this.canvas.height) {\n      this.handleResize();\n    }\n    \n    // Calculate timing\n    const time = timestamp * 0.001;\n    const deltaTime = Math.min(time - this.lastTime, 0.1);\n    this.lastTime = time;\n    \n    // Update profiler\n    this.profiler.beginFrame(timestamp);\n    \n    // Write uniforms\n    this.writeUniforms(time, deltaTime);\n    \n    // Create command encoder\n    const encoder = this.context.createCommandEncoder('frame');\n    \n    // Pass 1: Compute orbital positions\n    this.pipeline.encodeComputePass(encoder);\n    \n    // Pass 2: Scene rendering\n    this.pipeline.encodeScenePass(\n      encoder,\n      this.earthVertexBuffer,\n      this.earthIndexBuffer,\n      this.earthIndexCount\n    );\n    \n    // Passes 3-5: Bloom\n    this.pipeline.encodeBloomPasses(encoder);\n    \n    // Pass 6: Composite to screen\n    const outputView = this.context.getContext().getCurrentTexture().createView();\n    this.pipeline.encodeCompositePass(encoder, outputView);\n    \n    // Submit\n    this.context.submit([encoder.finish()]);\n    \n    // Update profiler\n    const stats = this.profiler.endFrame(timestamp);\n    if (stats) {\n      // Estimate visible satellites (this is approximate)\n      // In a full implementation, we'd use occlusion queries\n      stats.visibleSatellites = this.estimateVisibleSatellites();\n    }\n    \n    // Next frame\n    this.animationId = requestAnimationFrame(this.render);\n  };\n\n  /**\n   * Estimate visible satellites (simplified)\n   */\n  private estimateVisibleSatellites(): number {\n    // This is a rough estimate based on view mode\n    const mode = this.camera.getViewModeIndex();\n    if (mode === 0) {\n      // Horizon view - roughly 10-15% visible\n      return Math.floor(CONSTANTS.NUM_SATELLITES * 0.12);\n    } else if (mode === 2) {\n      // Fleet POV - very few visible\n      return Math.floor(CONSTANTS.NUM_SATELLITES * 0.001);\n    } else {\n      // God view - depends on distance\n      return Math.floor(CONSTANTS.NUM_SATELLITES * 0.25);\n    }\n  }\n\n  /**\n   * Start the render loop\n   */\n  start(): void {\n    if (this.isRunning) return;\n    this.isRunning = true;\n    this.animationId = requestAnimationFrame(this.render);\n  }\n\n  /**\n   * Stop the render loop\n   */\n  stop(): void {\n    this.isRunning = false;\n    cancelAnimationFrame(this.animationId);\n  }\n\n  /**\n   * Handle initialization errors\n   */\n  private handleError(error: unknown): void {\n    console.error('[GrokZephyr] Error:', error);\n    \n    let message = 'Unknown error occurred';\n    \n    if (error instanceof WebGPUError) {\n      message = error.message;\n    } else if (error instanceof Error) {\n      message = error.message;\n    }\n    \n    this.ui.showError(\n      message +\n      '<br><br>Please use a modern browser with WebGPU enabled (Chrome 113+, Edge 113+, or Firefox Nightly).'\n    );\n  }\n\n  /**\n   * Cleanup resources\n   */\n  destroy(): void {\n    this.stop();\n    this.pipeline?.destroy();\n    this.buffers?.destroy();\n    this.context?.destroy();\n    this.profiler.destroy();\n    this.earthVertexBuffer?.destroy();\n    this.earthIndexBuffer?.destroy();\n  }\n}\n\n/**\n * Initialize application when DOM is ready\n */\nfunction main(): void {\n  const app = new GrokZephyrApp();\n  app.initialize().catch(console.error);\n  \n  // Cleanup on page unload\n  window.addEventListener('beforeunload', () => {\n    app.destroy();\n  });\n  \n  // Expose for debugging\n  (window as unknown as { zephyr: GrokZephyrApp }).zephyr = app;\n}\n\n// Start\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', main);\n} else {\n  main();\n}\n\nexport default GrokZephyrApp;\n"],"names":["CameraController","__publicField","CAMERA","canvas","e","dx","dy","index","config","VIEW_MODES","satellitePosition","satelliteVelocity","time","CONSTANTS","yaw","pitch","distance","cosP","sinP","cosY","sinY","position","up","getPosition","getVelocity","satPos","satVel","radial","v3norm","v3add","v3scale","target","camera","aspect","view","mat4lookAt","projection","mat4persp","viewProjection","c","r","sum","k","viewMatrix","callback","UIManager","getEl","id","btn","i","modeName","altitude","fps","count","stats","message","PerformanceProfiler","options","UI","device","error","querySet","resolveBuffer","timestamp","now","frameTimeMs","elapsed","timeMs","mb","encoder","passType","_a","buffer","data","computeTime","renderTime","perf","jsHeapMB","maxSize","history","value","GrokZephyrApp","dpr","width","height","deltaTime","outputView","mode","name","WebGPUContext","SatelliteGPUBuffer","bufferSet","RenderPipeline","sphere","genSphere","vertexCount","interleaved","idx","t","right","frustum","extractFrustum","uniformData","BUFFER_SIZES","f32","u32","p","WebGPUError","_b","_c","_d","_e","main","app"],"mappings":"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"}